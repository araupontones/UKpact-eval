filter(value == 1)
clean_data <- raw_data %>%
pivot_longer(starts_with("Component"),
names_to = "Component") %>%
filter(value == 1) %>%
rename(IP = Implementor) %>%
relocate(Project, IP, Component)
clean_data <- raw_data %>%
pivot_longer(starts_with("Component"),
names_to = "Component") %>%
filter(value == 1) %>%
rename(IP = Implementor) %>%
relocate(Project, IP, Component) %>%
select(-value)
#export -----------------------------------------------------------------------
rio::export(clean_data, exfile)
app_data <- rio::import("data/app/projects.rds")
#create grouped data for app
# so users can display aggregations by theme and component in the map
library(dplyr)
group_data <- app_data %>%
group_by(Country, Theme, Component) %>%
summarise(projects = n())
group_data <- app_data %>%
group_by(Country, Theme, Component) %>%
summarise(projects = n(), .groups = 'drop')
View(group_data)
exfile <- "data/app/projects_group.rds"
#save --------------------------------------------------------------------------
rio::export(group_data, exfile)
library(shiny)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
sum_data <- rio::import("data/app/projects_group.rds")
View(sum_data)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
palette("Blues")
rev(brewer.pal(5, "Blues"))
runApp()
runApp()
#create grouped data for app
# so users can display aggregations by theme and component in the map
library(dplyr)
exfile <- "data/app/projects_group.rds"
app_data <- rio::import("data/app/projects.rds")
#group data -------------------------------------------------------------------
group_data <- app_data %>%
group_by(Country, Theme, Component) %>%
summarise(projects = n(), .groups = 'drop')
#save --------------------------------------------------------------------------
rio::export(group_data, exfile)
components <- unique(group_data$Component)
detect_vars <- function(look_for){
lapply(look_for, function(x){
set_num <- which(look_for == x)
print(set_num)
})
}
detect_vars(components)
detect_vars <- function(look_for){
.data %>%
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
mutate(var_name := "j")
})
}
test <- group_data %>%
detect_vars(components)
test <- group_data %>%
detect_vars(look_for = components)
detect_vars <- function(look_for){
.data %>%
mutate(apply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
var_name := "j"
}))
}
detect_vars(components)
detect_vars <- function(look_for){
.data %>%
mutate(apply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
'{{var_name}}' := "j"
}))
}
detect_vars(components)
detect_vars <- function(look_for){
.data %>%
mutate(lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
'{{var_name}}' := "j"
}))
}
detect_vars(components)
detect_vars <- function(look_for){
.data %>%
mutate(lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
p = "j"
}))
}
detect_vars(components)
detect_vars <- function(look_for){
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
p = "j"
.data %>%
mutate(p = "k")
})
}
detect_vars(components)
detect_vars <- function(.data,look_for){
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
p = "j"
.data %>%
mutate(p = "k")
})
}
detect_vars(components)
detect_vars(look_for,components)
detect_vars(look_for= components)
test <- group_data %>%
detect_vars(look_for = components)
View(test)
detect_vars <- function(.data,look_for){
.data %>%
mutate()
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
p = "j"
})
}
test <- group_data %>%
detect_vars(look_for = components)
detect_vars <- function(.data,look_for){
.data %>%
mutate()
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
var_nam := "j"
})
}
test <- group_data %>%
detect_vars(look_for = components)
detect_vars <- function(.data,look_for){
.data %>%
mutate()
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
"{{var_nam}}" := "j"
})
}
test <- group_data %>%
detect_vars(look_for = components)
detect_vars <- function(.data,look_for){
.data %>%
mutate(
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
"{{var_nam}}" := "j"
})
)
}
test <- group_data %>%
detect_vars(look_for = components)
detect_vars <- function(.data,look_for){
.data %>%
mutate(
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
p = "j"
})
)
}
test <- group_data %>%
detect_vars(look_for = components)
detect_vars <- function(.data,look_for){
.data %>%
mutate(
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
p = var_nam
})
)
}
test <- group_data %>%
detect_vars(look_for = components)
test <- group_data %>%
mutate(sapply(c(p,d), function(x) 7 ))
test <- group_data %>%
mutate(sapply(c(p,d), function(x) .[[p]] = 7 ))
test <- group_data %>%
mutate(sapply(c(p,d), function(x) .[["s"]] = 7 ))
test <- group_data %>%
mutate(sapply(c(p,d), function(x) x = 7 ))
detect_vars <- function(.data,look_for){
mutate(.data,
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
p = var_nam
})
)
}
detect_vars(group_data, components)
detect_vars <- function(.data,look_for){
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
p = var_nam
mutate(.data,p = var_nam  )
})
}
detect_vars(group_data, components)
detect_vars <- function(.data,look_for){
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
mutate(.data, {{var_nam}} = var_nam  )
})
}
detect_vars(group_data, components)
detect_vars <- function(.data,look_for){
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
mutate(.data, {{var_nam}} = var_nam  )
})
}
detect_vars <- function(.data,look_for){
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
mutate(.data, {{var_nam}} := var_nam  )
})
}
detect_vars(group_data, components)
detect_vars <- function(.data,look_for){
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
mutate(.data, {{var_nam}} := Component == x )
})
}
detect_vars(group_data, components)
detect_vars <- function(.data,look_for){
lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
data_look <- mutate(.data, {{var_nam}} := Component == x ) %>%
select(Country, {{var_nam}})
})
}
detect_vars(group_data, components)
detect_vars <- function(.data,look_for){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
data_look <- mutate(.data, {{var_nam}} := Component == x ) %>%
select({{var_nam}})
})
cbind(.data, data_look)
}
detect_vars(group_data, components)
detect_vars <- function(.data,look_for){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
data_look <- mutate(.data, {{var_nam}} := Component == x ) %>%
select({{var_nam}})
cbind(data, data_look)
})
}
detect_vars(group_data, components)
detect_vars <- function(.data,look_for){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
data_look <- mutate(.data, {{var_nam}} := Component == x ) %>%
select({{var_nam}})
cbind(.data, data_look)
})
}
detect_vars(group_data, components)
detect_vars(group_data, components)
test <- detect_vars(group_data, components)
View(test)
detect_vars <- function(.data,look_for){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
data_look <- mutate(.data, {{var_nam}} := Component == x ) %>%
select({{var_nam}})
})
cbind(datas)
}
test <- detect_vars(group_data, components)
View(test)
View(test[[1]][[1]])
test <- group_data %>%
mutate(sapply(c(p,d), function(x) x = 7 ))
View(test)
detect_vars <- function(.data,look_for){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0("name_", set_num)
data_look <- mutate(.data, {{var_nam}} := Component == x ) %>%
select({{var_nam}})
})
}
test <- detect_vars(group_data, components)
View(test)
test_2 <- do.call(cbind, test)
View(test_2)
detect_vars <- function(.data,look_for, prefix){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0(prefix, set_num)
data_look <- mutate(.data, {{var_nam}} := Component == x ) %>%
select({{var_nam}})
})
}
test <- detect_vars(group_data, components, prefix = "comp")
test_2 <- do.call(cbind, test)
View(test_2)
test_3 <- cbind(group_datam test_2)
test_3 <- cbind(group_datam,test_2)
test_3 <- cbind(group_data, test_2)
View(test_3)
components
bind_detect <- function(db, lkp, prefix){
detect <- detect_vars(group_data, components, prefix = prefix)
detect_bin <- do.call(cbind, detect)
with_original <- cbind(db, detect_bin)
}
test <- bind_detect()
test <- bind_detect(db = group_data, lkp = components, prefix = "comp_")
View(test)
bind_detect <- function(.data, lkp, prefix){
detect <- detect_vars(.data, lkp, prefix = prefix)
detect_bin <- do.call(cbind, detect)
with_original <- cbind(db, detect_bin)
}
test <- bind_detect(.data = group_data, lkp = components, prefix = "comp_")
bind_detect <- function(.data, lkp, prefix){
detect <- detect_vars(.data, lkp, prefix = prefix)
detect_bin <- do.call(cbind, detect)
with_original <- cbind(.data, detect_bin)
}
test <- bind_detect(.data = group_data, lkp = components, prefix = "comp_")
View(test)
test2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_")
View(test2)
themes(unique(group_data$Theme))
themes <- unique(group_data$Theme)
test2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_") %>%
bind_detect(., lkp = themes, prefix = "theme_")
View(test2)
detect_vars <- function(.data,look_for, prefix, target){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0(prefix, set_num)
data_look <- mutate(.data, {{var_nam}} := target == x ) %>%
select({{var_nam}})
})
}
bind_detect <- function(.data, lkp, prefix, target){
detect <- detect_vars(.data, lkp, prefix = prefix, target)
detect_bin <- do.call(cbind, detect)
with_original <- cbind(.data, detect_bin)
}
test2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_", target = Component) %>%
bind_detect(., lkp = themes, prefix = "theme_", target = Theme)
detect_vars <- function(.data,look_for, prefix, target){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0(prefix, set_num)
data_look <- mutate(.data, {{var_nam}} := {{target}} == x ) %>%
select({{var_nam}})
})
}
bind_detect <- function(.data, lkp, prefix, target){
detect <- detect_vars(.data, lkp, prefix = prefix, target)
detect_bin <- do.call(cbind, detect)
with_original <- cbind(.data, detect_bin)
}
test2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_", target = Component) %>%
bind_detect(., lkp = themes, prefix = "theme_", target = Theme)
detect_vars <- function(.data,look_for, prefix, target){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0(prefix, set_num)
data_look <- mutate(.data, {{var_nam}} := {{target}} == x ) %>%
select({{var_nam}})
})
}
bind_detect <- function(.data, lkp, prefix, target){
detect <- detect_vars(.data, lkp, prefix = prefix, target = target)
detect_bin <- do.call(cbind, detect)
with_original <- cbind(.data, detect_bin)
}
test2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_", target = Component) %>%
bind_detect(., lkp = themes, prefix = "theme_", target = Theme)
detect_vars <- function(.data,look_for, prefix, target){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0(prefix, set_num)
data_look <- mutate(.data, {{var_nam}} := Component == x ) %>%
select({{var_nam}})
})
}
bind_detect <- function(.data, lkp, prefix, target){
detect <- detect_vars(.data, lkp, prefix = prefix, target = target)
detect_bin <- do.call(cbind, detect)
with_original <- cbind(.data, detect_bin)
}
test2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_", target = Component) %>%
bind_detect(., lkp = themes, prefix = "theme_", target = Theme)
detect_vars <- function(.data,look_for, prefix, target){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0(prefix, set_num)
data_look <- mutate(.data, {{var_nam}} := {{target}} == x ) %>%
select({{var_nam}})
})
}
bind_detect <- function(.data, lkp, prefix, target){
detect <- detect_vars(.data, lkp, prefix = prefix, target = target)
detect_bin <- do.call(cbind, detect)
with_original <- cbind(.data, detect_bin)
}
test2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_", target = Component) %>%
bind_detect(., lkp = themes, prefix = "theme_", target = Theme)
detect_vars <- function(.data,look_for, prefix, target){
datas <- lapply(look_for, function(x){
set_num <- which(look_for == x)
var_nam <- paste0(prefix, set_num)
data_look <- mutate(.data, {{var_nam}} := .data[[target]] == x ) %>%
select({{var_nam}})
})
}
bind_detect <- function(.data, lkp, prefix, target){
detect <- detect_vars(.data, lkp, prefix = prefix, target = target)
detect_bin <- do.call(cbind, detect)
with_original <- cbind(.data, detect_bin)
}
test2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_", target = Component) %>%
bind_detect(., lkp = themes, prefix = "theme_", target = Theme)
test2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_", target = "Component") %>%
bind_detect(., lkp = themes, prefix = "theme_", target = Theme)
test2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_", target = "Component") %>%
bind_detect(., lkp = themes, prefix = "theme_", target = "Theme")
test_2 <- group_data %>%
bind_detect(.,lkp = components, prefix = "comp_", target = "Component") %>%
bind_detect(., lkp = themes, prefix = "theme_", target = "Theme")
View(test_2)
themes
